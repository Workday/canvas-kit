"use strict";(globalThis.webpackChunkcanvas_kit=globalThis.webpackChunkcanvas_kit||[]).push([[1984],{"./modules/react/popup/stories/visual-testing/Popper.stories.tsx":(module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PopperRTL=exports.CustomPlacement=exports.default=void 0;var React=function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&{}.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n.default=e,t&&t.set(e,n),n}(__webpack_require__("./node_modules/react/index.js")),_common=__webpack_require__("./modules/react/common/index.ts"),_menu=__webpack_require__("./modules/react/menu/index.ts"),_popup=__webpack_require__("./modules/react/popup/index.ts"),_tokens=__webpack_require__("./modules/react/tokens/index.ts");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function(e){return e?t:r})(e)}var _default={title:"Testing/Popups/Popper",component:_popup.Popper,parameters:{storySource:{source:'\n    \n    // @ts-nocheck\n    // @ts-expect-error (Converted from ts-ignore)\n    var __STORY__ = "import * as React from \'react\';\\nimport {CanvasProvider, ContentDirection} from \'@workday/canvas-kit-react/common\';\\nimport {Menu} from \'@workday/canvas-kit-react/menu\';\\nimport {Popup, Popper} from \'@workday/canvas-kit-react/popup\';\\nimport {colors, space, borderRadius} from \'@workday/canvas-kit-react/tokens\';\\n\\nexport default {\\n  title: \'Testing/Popups/Popper\',\\n  component: Popper,\\n  parameters: {\\n    chromatic: {\\n      disable: false,\\n    },\\n  },\\n};\\n\\nconst containerStyles: React.CSSProperties = {\\n  display: \'flex\',\\n  alignItems: \'center\',\\n  justifyContent: \'center\',\\n\\n  width: 400,\\n  height: 400,\\n};\\n\\nconst innerContainerStyles: React.CSSProperties = {\\n  overflow: \'hidden\',\\n\\n  width: 200,\\n  height: 200,\\n  padding: space.m,\\n\\n  border: `1px solid ${colors.blueberry500}`,\\n  borderRadius: borderRadius.l,\\n};\\n\\nconst squareStyles: React.CSSProperties = {\\n  position: \'absolute\',\\n  left: 190,\\n  top: 250,\\n};\\n\\nexport const CustomPlacement = {\\n  render: () => {\\n    const ownerRef = React.useRef<HTMLDivElement>(null);\\n    const virtualLeft = 190 + 30; // square offset + red box offset\\n    const virtualTop = 250 + 30; // square offset + red box offset\\n    return (\\n      <div style={containerStyles}>\\n        <div style={innerContainerStyles}>\\n          {\\n            \'The element with the black square owns the Popper while it is virtually positioned to the red square:\'\\n          }\\n          <div style={squareStyles} ref={ownerRef}>\\n            <svg\\n              xmlns=\\"http://www.w3.org/2000/svg\\"\\n              width=\\"100\\"\\n              height=\\"100\\"\\n              fill=\\"none\\"\\n              viewBox=\\"0 0 100 100\\"\\n            >\\n              <path stroke={colors.blackPepper400} d=\\"M0.5 0.5H99.5V99.5H0.5z\\"></path>\\n              <path fill={colors.cinnamon400} d=\\"M30 30H70V70H30z\\"></path>\\n            </svg>\\n          </div>\\n          <Popper\\n            anchorElement={ownerRef}\\n            getAnchorClientRect={() => ({\\n              top: virtualTop,\\n              left: virtualLeft,\\n              width: 40,\\n              height: 40,\\n              bottom: virtualTop + 40,\\n              right: virtualLeft + 40,\\n              x: virtualLeft,\\n              y: virtualTop,\\n              toJSON: () => \'\',\\n            })}\\n          >\\n            <Menu>\\n              <Menu.Card>\\n                <Menu.List>\\n                  <Menu.Item>Custom</Menu.Item>\\n                  <Menu.Item>Placement</Menu.Item>\\n                </Menu.List>\\n              </Menu.Card>\\n            </Menu>\\n          </Popper>\\n        </div>\\n      </div>\\n    );\\n  },\\n};\\n\\nexport const PopperRTL = () => (\\n  <CanvasProvider theme={{canvas: {direction: ContentDirection.RTL}}}>\\n    <Popper open={true}>\\n      <Popup.Card style={{animation: \'none\'}} width={300}>\\n        <Popup.CloseIcon aria-label=\\"\\" />\\n        <Popup.Heading>למחוק פריט</Popup.Heading>\\n        <Popup.Body>האם ברצונך למחוק פריט זה</Popup.Body>\\n      </Popup.Card>\\n    </Popper>\\n  </CanvasProvider>\\n);\\n";\n    // @ts-expect-error (Converted from ts-ignore)\n    var __LOCATIONS_MAP__ = {\n  "CustomPlacement": {\n    "startLoc": {\n      "col": 31,\n      "line": 43\n    },\n    "endLoc": {\n      "col": 1,\n      "line": 93\n    },\n    "startBody": {\n      "col": 31,\n      "line": 43\n    },\n    "endBody": {\n      "col": 1,\n      "line": 93\n    }\n  },\n  "PopperRTL": {\n    "startLoc": {\n      "col": 25,\n      "line": 95\n    },\n    "endLoc": {\n      "col": 1,\n      "line": 105\n    },\n    "startBody": {\n      "col": 25,\n      "line": 95\n    },\n    "endBody": {\n      "col": 1,\n      "line": 105\n    }\n  }\n};\n    \nimport * as React from \'react\';\nimport {CanvasProvider, ContentDirection} from \'@workday/canvas-kit-react/common\';\nimport {Menu} from \'@workday/canvas-kit-react/menu\';\nimport {Popup, Popper} from \'@workday/canvas-kit-react/popup\';\nimport {colors, space, borderRadius} from \'@workday/canvas-kit-react/tokens\';\n\nexport default {\n  title: \'Testing/Popups/Popper\',\n  component: Popper,\n  parameters: {\n  "storySource": {\n    "source": "import * as React from \'react\';\\nimport {CanvasProvider, ContentDirection} from \'@workday/canvas-kit-react/common\';\\nimport {Menu} from \'@workday/canvas-kit-react/menu\';\\nimport {Popup, Popper} from \'@workday/canvas-kit-react/popup\';\\nimport {colors, space, borderRadius} from \'@workday/canvas-kit-react/tokens\';\\n\\nexport default {\\n  title: \'Testing/Popups/Popper\',\\n  component: Popper,\\n  parameters: {\\n    chromatic: {\\n      disable: false,\\n    },\\n  },\\n};\\n\\nconst containerStyles: React.CSSProperties = {\\n  display: \'flex\',\\n  alignItems: \'center\',\\n  justifyContent: \'center\',\\n\\n  width: 400,\\n  height: 400,\\n};\\n\\nconst innerContainerStyles: React.CSSProperties = {\\n  overflow: \'hidden\',\\n\\n  width: 200,\\n  height: 200,\\n  padding: space.m,\\n\\n  border: `1px solid ${colors.blueberry500}`,\\n  borderRadius: borderRadius.l,\\n};\\n\\nconst squareStyles: React.CSSProperties = {\\n  position: \'absolute\',\\n  left: 190,\\n  top: 250,\\n};\\n\\nexport const CustomPlacement = {\\n  render: () => {\\n    const ownerRef = React.useRef<HTMLDivElement>(null);\\n    const virtualLeft = 190 + 30; // square offset + red box offset\\n    const virtualTop = 250 + 30; // square offset + red box offset\\n    return (\\n      <div style={containerStyles}>\\n        <div style={innerContainerStyles}>\\n          {\\n            \'The element with the black square owns the Popper while it is virtually positioned to the red square:\'\\n          }\\n          <div style={squareStyles} ref={ownerRef}>\\n            <svg\\n              xmlns=\\"http://www.w3.org/2000/svg\\"\\n              width=\\"100\\"\\n              height=\\"100\\"\\n              fill=\\"none\\"\\n              viewBox=\\"0 0 100 100\\"\\n            >\\n              <path stroke={colors.blackPepper400} d=\\"M0.5 0.5H99.5V99.5H0.5z\\"></path>\\n              <path fill={colors.cinnamon400} d=\\"M30 30H70V70H30z\\"></path>\\n            </svg>\\n          </div>\\n          <Popper\\n            anchorElement={ownerRef}\\n            getAnchorClientRect={() => ({\\n              top: virtualTop,\\n              left: virtualLeft,\\n              width: 40,\\n              height: 40,\\n              bottom: virtualTop + 40,\\n              right: virtualLeft + 40,\\n              x: virtualLeft,\\n              y: virtualTop,\\n              toJSON: () => \'\',\\n            })}\\n          >\\n            <Menu>\\n              <Menu.Card>\\n                <Menu.List>\\n                  <Menu.Item>Custom</Menu.Item>\\n                  <Menu.Item>Placement</Menu.Item>\\n                </Menu.List>\\n              </Menu.Card>\\n            </Menu>\\n          </Popper>\\n        </div>\\n      </div>\\n    );\\n  },\\n};\\n\\nexport const PopperRTL = () => (\\n  <CanvasProvider theme={{canvas: {direction: ContentDirection.RTL}}}>\\n    <Popper open={true}>\\n      <Popup.Card style={{animation: \'none\'}} width={300}>\\n        <Popup.CloseIcon aria-label=\\"\\" />\\n        <Popup.Heading>למחוק פריט</Popup.Heading>\\n        <Popup.Body>האם ברצונך למחוק פריט זה</Popup.Body>\\n      </Popup.Card>\\n    </Popper>\\n  </CanvasProvider>\\n);\\n",\n    "locationsMap": {\n      "custom-placement": {\n        "startLoc": {\n          "col": 31,\n          "line": 43\n        },\n        "endLoc": {\n          "col": 1,\n          "line": 93\n        },\n        "startBody": {\n          "col": 31,\n          "line": 43\n        },\n        "endBody": {\n          "col": 1,\n          "line": 93\n        }\n      },\n      "popper-rtl": {\n        "startLoc": {\n          "col": 25,\n          "line": 95\n        },\n        "endLoc": {\n          "col": 1,\n          "line": 105\n        },\n        "startBody": {\n          "col": 25,\n          "line": 95\n        },\n        "endBody": {\n          "col": 1,\n          "line": 105\n        }\n      }\n    }\n  }\n,\n    chromatic: {\n      disable: false,\n    },\n  },\n};\n\nconst containerStyles: React.CSSProperties = {\n  display: \'flex\',\n  alignItems: \'center\',\n  justifyContent: \'center\',\n\n  width: 400,\n  height: 400,\n};\n\nconst innerContainerStyles: React.CSSProperties = {\n  overflow: \'hidden\',\n\n  width: 200,\n  height: 200,\n  padding: space.m,\n\n  border: `1px solid ${colors.blueberry500}`,\n  borderRadius: borderRadius.l,\n};\n\nconst squareStyles: React.CSSProperties = {\n  position: \'absolute\',\n  left: 190,\n  top: 250,\n};\n\nexport const CustomPlacement = {\n  render: () => {\n    const ownerRef = React.useRef<HTMLDivElement>(null);\n    const virtualLeft = 190 + 30; // square offset + red box offset\n    const virtualTop = 250 + 30; // square offset + red box offset\n    return (\n      <div style={containerStyles}>\n        <div style={innerContainerStyles}>\n          {\n            \'The element with the black square owns the Popper while it is virtually positioned to the red square:\'\n          }\n          <div style={squareStyles} ref={ownerRef}>\n            <svg\n              xmlns="http://www.w3.org/2000/svg"\n              width="100"\n              height="100"\n              fill="none"\n              viewBox="0 0 100 100"\n            >\n              <path stroke={colors.blackPepper400} d="M0.5 0.5H99.5V99.5H0.5z"></path>\n              <path fill={colors.cinnamon400} d="M30 30H70V70H30z"></path>\n            </svg>\n          </div>\n          <Popper\n            anchorElement={ownerRef}\n            getAnchorClientRect={() => ({\n              top: virtualTop,\n              left: virtualLeft,\n              width: 40,\n              height: 40,\n              bottom: virtualTop + 40,\n              right: virtualLeft + 40,\n              x: virtualLeft,\n              y: virtualTop,\n              toJSON: () => \'\',\n            })}\n          >\n            <Menu>\n              <Menu.Card>\n                <Menu.List>\n                  <Menu.Item>Custom</Menu.Item>\n                  <Menu.Item>Placement</Menu.Item>\n                </Menu.List>\n              </Menu.Card>\n            </Menu>\n          </Popper>\n        </div>\n      </div>\n    );\n  },\n};;\n\nexport const PopperRTL = () => (\n  <CanvasProvider theme={{canvas: {direction: ContentDirection.RTL}}}>\n    <Popper open={true}>\n      <Popup.Card style={{animation: \'none\'}} width={300}>\n        <Popup.CloseIcon aria-label="" />\n        <Popup.Heading>למחוק פריט</Popup.Heading>\n        <Popup.Body>האם ברצונך למחוק פריט זה</Popup.Body>\n      </Popup.Card>\n    </Popper>\n  </CanvasProvider>\n);\n',locationsMap:{"custom-placement":{startLoc:{col:31,line:130},endLoc:{col:1,line:180},startBody:{col:31,line:130},endBody:{col:1,line:180}},"popper-rtl":{startLoc:{col:25,line:182},endLoc:{col:1,line:192},startBody:{col:25,line:182},endBody:{col:1,line:192}}}},storySource:{source:"import * as React from 'react';\nimport {CanvasProvider, ContentDirection} from '@workday/canvas-kit-react/common';\nimport {Menu} from '@workday/canvas-kit-react/menu';\nimport {Popup, Popper} from '@workday/canvas-kit-react/popup';\nimport {colors, space, borderRadius} from '@workday/canvas-kit-react/tokens';\n\nexport default {\n  title: 'Testing/Popups/Popper',\n  component: Popper,\n  parameters: {\n    chromatic: {\n      disable: false,\n    },\n  },\n};\n\nconst containerStyles: React.CSSProperties = {\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'center',\n\n  width: 400,\n  height: 400,\n};\n\nconst innerContainerStyles: React.CSSProperties = {\n  overflow: 'hidden',\n\n  width: 200,\n  height: 200,\n  padding: space.m,\n\n  border: `1px solid ${colors.blueberry500}`,\n  borderRadius: borderRadius.l,\n};\n\nconst squareStyles: React.CSSProperties = {\n  position: 'absolute',\n  left: 190,\n  top: 250,\n};\n\nexport const CustomPlacement = {\n  render: () => {\n    const ownerRef = React.useRef<HTMLDivElement>(null);\n    const virtualLeft = 190 + 30; // square offset + red box offset\n    const virtualTop = 250 + 30; // square offset + red box offset\n    return (\n      <div style={containerStyles}>\n        <div style={innerContainerStyles}>\n          {\n            'The element with the black square owns the Popper while it is virtually positioned to the red square:'\n          }\n          <div style={squareStyles} ref={ownerRef}>\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              width=\"100\"\n              height=\"100\"\n              fill=\"none\"\n              viewBox=\"0 0 100 100\"\n            >\n              <path stroke={colors.blackPepper400} d=\"M0.5 0.5H99.5V99.5H0.5z\"></path>\n              <path fill={colors.cinnamon400} d=\"M30 30H70V70H30z\"></path>\n            </svg>\n          </div>\n          <Popper\n            anchorElement={ownerRef}\n            getAnchorClientRect={() => ({\n              top: virtualTop,\n              left: virtualLeft,\n              width: 40,\n              height: 40,\n              bottom: virtualTop + 40,\n              right: virtualLeft + 40,\n              x: virtualLeft,\n              y: virtualTop,\n              toJSON: () => '',\n            })}\n          >\n            <Menu>\n              <Menu.Card>\n                <Menu.List>\n                  <Menu.Item>Custom</Menu.Item>\n                  <Menu.Item>Placement</Menu.Item>\n                </Menu.List>\n              </Menu.Card>\n            </Menu>\n          </Popper>\n        </div>\n      </div>\n    );\n  },\n};\n\nexport const PopperRTL = () => (\n  <CanvasProvider theme={{canvas: {direction: ContentDirection.RTL}}}>\n    <Popper open={true}>\n      <Popup.Card style={{animation: 'none'}} width={300}>\n        <Popup.CloseIcon aria-label=\"\" />\n        <Popup.Heading>למחוק פריט</Popup.Heading>\n        <Popup.Body>האם ברצונך למחוק פריט זה</Popup.Body>\n      </Popup.Card>\n    </Popper>\n  </CanvasProvider>\n);\n",locationsMap:{"custom-placement":{startLoc:{col:31,line:43},endLoc:{col:1,line:93},startBody:{col:31,line:43},endBody:{col:1,line:93}},"popper-rtl":{startLoc:{col:25,line:95},endLoc:{col:1,line:105},startBody:{col:25,line:95},endBody:{col:1,line:105}}}},chromatic:{disable:!1}}};exports.default=_default;const containerStyles={display:"flex",alignItems:"center",justifyContent:"center",width:400,height:400},innerContainerStyles={overflow:"hidden",width:200,height:200,padding:_tokens.space.m,border:`1px solid ${_tokens.colors.blueberry500}`,borderRadius:_tokens.borderRadius.l},squareStyles={position:"absolute",left:190,top:250},CustomPlacement={render:()=>{const ownerRef=React.useRef(null);return React.createElement("div",{style:containerStyles},React.createElement("div",{style:innerContainerStyles},"The element with the black square owns the Popper while it is virtually positioned to the red square:",React.createElement("div",{style:squareStyles,ref:ownerRef},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100",height:"100",fill:"none",viewBox:"0 0 100 100"},React.createElement("path",{stroke:_tokens.colors.blackPepper400,d:"M0.5 0.5H99.5V99.5H0.5z"}),React.createElement("path",{fill:_tokens.colors.cinnamon400,d:"M30 30H70V70H30z"}))),React.createElement(_popup.Popper,{anchorElement:ownerRef,getAnchorClientRect:()=>({top:280,left:220,width:40,height:40,bottom:320,right:260,x:220,y:280,toJSON:()=>""})},React.createElement(_menu.Menu,null,React.createElement(_menu.Menu.Card,null,React.createElement(_menu.Menu.List,null,React.createElement(_menu.Menu.Item,null,"Custom"),React.createElement(_menu.Menu.Item,null,"Placement")))))))}};exports.CustomPlacement=CustomPlacement;const PopperRTL=()=>React.createElement(_common.CanvasProvider,{theme:{canvas:{direction:_common.ContentDirection.RTL}}},React.createElement(_popup.Popper,{open:!0},React.createElement(_popup.Popup.Card,{style:{animation:"none"},width:300},React.createElement(_popup.Popup.CloseIcon,{"aria-label":""}),React.createElement(_popup.Popup.Heading,null,"למחוק פריט"),React.createElement(_popup.Popup.Body,null,"האם ברצונך למחוק פריט זה"))));exports.PopperRTL=PopperRTL,PopperRTL.displayName="PopperRTL",module.exports.__namedExportsOrder=["PopperRTL","CustomPlacement"]},"./node_modules/react-innertext/index.js":module=>{var reduceJsxToString=function(previous,current){return previous+innerText(current)},innerText=function(jsx){return null===jsx||"boolean"==typeof jsx||void 0===jsx?"":"number"==typeof jsx?jsx.toString():"string"==typeof jsx?jsx:Array.isArray(jsx)?jsx.reduce(reduceJsxToString,""):function(jsx){return Object.prototype.hasOwnProperty.call(jsx,"props")}(jsx)&&Object.prototype.hasOwnProperty.call(jsx.props,"children")?innerText(jsx.props.children):""};innerText.default=innerText,module.exports=innerText},"./node_modules/react-virtual/dist/react-virtual.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{defaultRangeExtractor:()=>defaultRangeExtractor,useVirtual:()=>useVirtual});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function _extends(){return _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}var rafId,props=["bottom","height","left","right","top","width"],observedNodes=new Map,run=function run(){var changedStates=[];observedNodes.forEach((function(state,node){var newRect=node.getBoundingClientRect();(function rectChanged(a,b){return void 0===a&&(a={}),void 0===b&&(b={}),props.some((function(prop){return a[prop]!==b[prop]}))})(newRect,state.rect)&&(state.rect=newRect,changedStates.push(state))})),changedStates.forEach((function(state){state.callbacks.forEach((function(cb){return cb(state.rect)}))})),rafId=window.requestAnimationFrame(run)};var useIsomorphicLayoutEffect="undefined"!=typeof window?react__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect:react__WEBPACK_IMPORTED_MODULE_0__.useEffect;function useRect(nodeRef,initialRect){void 0===initialRect&&(initialRect={width:0,height:0});var _React$useState=react__WEBPACK_IMPORTED_MODULE_0__.useState(nodeRef.current),element=_React$useState[0],setElement=_React$useState[1],_React$useReducer=react__WEBPACK_IMPORTED_MODULE_0__.useReducer(rectReducer,initialRect),rect=_React$useReducer[0],dispatch=_React$useReducer[1],initialRectSet=react__WEBPACK_IMPORTED_MODULE_0__.useRef(!1);return useIsomorphicLayoutEffect((function(){nodeRef.current!==element&&setElement(nodeRef.current)})),useIsomorphicLayoutEffect((function(){if(element&&!initialRectSet.current){initialRectSet.current=!0;var _rect=element.getBoundingClientRect();dispatch({rect:_rect})}}),[element]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){if(element){var observer=function observeRect(node,cb){return{observe:function observe(){var wasEmpty=0===observedNodes.size;observedNodes.has(node)?observedNodes.get(node).callbacks.push(cb):observedNodes.set(node,{rect:void 0,hasRectChanged:!1,callbacks:[cb]}),wasEmpty&&run()},unobserve:function unobserve(){var state=observedNodes.get(node);if(state){var index=state.callbacks.indexOf(cb);index>=0&&state.callbacks.splice(index,1),state.callbacks.length||observedNodes.delete(node),observedNodes.size||cancelAnimationFrame(rafId)}}}}(element,(function(rect){dispatch({rect})}));return observer.observe(),function(){observer.unobserve()}}}),[element]),rect}function rectReducer(state,action){var rect=action.rect;return state.height!==rect.height||state.width!==rect.width?rect:state}var defaultEstimateSize=function defaultEstimateSize(){return 50},defaultKeyExtractor=function defaultKeyExtractor(index){return index},defaultMeasureSize=function defaultMeasureSize(el,horizontal){return el[horizontal?"offsetWidth":"offsetHeight"]},defaultRangeExtractor=function defaultRangeExtractor(range){for(var start=Math.max(range.start-range.overscan,0),end=Math.min(range.end+range.overscan,range.size-1),arr=[],i=start;i<=end;i++)arr.push(i);return arr};function useVirtual(_ref){var _measurements,_ref$size=_ref.size,size=void 0===_ref$size?0:_ref$size,_ref$estimateSize=_ref.estimateSize,estimateSize=void 0===_ref$estimateSize?defaultEstimateSize:_ref$estimateSize,_ref$overscan=_ref.overscan,overscan=void 0===_ref$overscan?1:_ref$overscan,_ref$paddingStart=_ref.paddingStart,paddingStart=void 0===_ref$paddingStart?0:_ref$paddingStart,_ref$paddingEnd=_ref.paddingEnd,paddingEnd=void 0===_ref$paddingEnd?0:_ref$paddingEnd,parentRef=_ref.parentRef,horizontal=_ref.horizontal,scrollToFn=_ref.scrollToFn,useObserver=_ref.useObserver,initialRect=_ref.initialRect,onScrollElement=_ref.onScrollElement,scrollOffsetFn=_ref.scrollOffsetFn,_ref$keyExtractor=_ref.keyExtractor,keyExtractor=void 0===_ref$keyExtractor?defaultKeyExtractor:_ref$keyExtractor,_ref$measureSize=_ref.measureSize,measureSize=void 0===_ref$measureSize?defaultMeasureSize:_ref$measureSize,_ref$rangeExtractor=_ref.rangeExtractor,rangeExtractor=void 0===_ref$rangeExtractor?defaultRangeExtractor:_ref$rangeExtractor,sizeKey=horizontal?"width":"height",scrollKey=horizontal?"scrollLeft":"scrollTop",latestRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef({scrollOffset:0,measurements:[]}),_React$useState=react__WEBPACK_IMPORTED_MODULE_0__.useState(0),scrollOffset=_React$useState[0],setScrollOffset=_React$useState[1];latestRef.current.scrollOffset=scrollOffset;var outerSize=(useObserver||useRect)(parentRef,initialRect)[sizeKey];latestRef.current.outerSize=outerSize;var defaultScrollToFn=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(offset){parentRef.current&&(parentRef.current[scrollKey]=offset)}),[parentRef,scrollKey]),resolvedScrollToFn=scrollToFn||defaultScrollToFn;scrollToFn=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(offset){resolvedScrollToFn(offset,defaultScrollToFn)}),[defaultScrollToFn,resolvedScrollToFn]);var _React$useState2=react__WEBPACK_IMPORTED_MODULE_0__.useState({}),measuredCache=_React$useState2[0],setMeasuredCache=_React$useState2[1],measure=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(){return setMeasuredCache({})}),[]),pendingMeasuredCacheIndexesRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef([]),measurements=react__WEBPACK_IMPORTED_MODULE_0__.useMemo((function(){var min=pendingMeasuredCacheIndexesRef.current.length>0?Math.min.apply(Math,pendingMeasuredCacheIndexesRef.current):0;pendingMeasuredCacheIndexesRef.current=[];for(var measurements=latestRef.current.measurements.slice(0,min),i=min;i<size;i++){var key=keyExtractor(i),measuredSize=measuredCache[key],_start=measurements[i-1]?measurements[i-1].end:paddingStart,_size="number"==typeof measuredSize?measuredSize:estimateSize(i),_end=_start+_size;measurements[i]={index:i,start:_start,size:_size,end:_end,key}}return measurements}),[estimateSize,measuredCache,paddingStart,size,keyExtractor]),totalSize=((null==(_measurements=measurements[size-1])?void 0:_measurements.end)||paddingStart)+paddingEnd;latestRef.current.measurements=measurements,latestRef.current.totalSize=totalSize;var element=onScrollElement?onScrollElement.current:parentRef.current,scrollOffsetFnRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(scrollOffsetFn);scrollOffsetFnRef.current=scrollOffsetFn,useIsomorphicLayoutEffect((function(){if(element){var onScroll=function onScroll(event){var offset=scrollOffsetFnRef.current?scrollOffsetFnRef.current(event):element[scrollKey];setScrollOffset(offset)};return onScroll(),element.addEventListener("scroll",onScroll,{capture:!1,passive:!0}),function(){element.removeEventListener("scroll",onScroll)}}setScrollOffset(0)}),[element,scrollKey]);var _calculateRange=function calculateRange(_ref4){var measurements=_ref4.measurements,outerSize=_ref4.outerSize,scrollOffset=_ref4.scrollOffset,size=measurements.length-1,getOffset=function getOffset(index){return measurements[index].start},start=findNearestBinarySearch(0,size,getOffset,scrollOffset),end=start;for(;end<size&&measurements[end].end<scrollOffset+outerSize;)end++;return{start,end}}(latestRef.current),start=_calculateRange.start,end=_calculateRange.end,indexes=react__WEBPACK_IMPORTED_MODULE_0__.useMemo((function(){return rangeExtractor({start,end,overscan,size:measurements.length})}),[start,end,overscan,measurements.length,rangeExtractor]),measureSizeRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(measureSize);measureSizeRef.current=measureSize;var virtualItems=react__WEBPACK_IMPORTED_MODULE_0__.useMemo((function(){for(var virtualItems=[],_loop=function _loop(k,len){var i=indexes[k],item=_extends(_extends({},measurements[i]),{},{measureRef:function measureRef(el){if(el){var measuredSize=measureSizeRef.current(el,horizontal);if(measuredSize!==item.size){var _scrollOffset=latestRef.current.scrollOffset;item.start<_scrollOffset&&defaultScrollToFn(_scrollOffset+(measuredSize-item.size)),pendingMeasuredCacheIndexesRef.current.push(i),setMeasuredCache((function(old){var _extends2;return _extends(_extends({},old),{},((_extends2={})[item.key]=measuredSize,_extends2))}))}}}});virtualItems.push(item)},k=0,len=indexes.length;k<len;k++)_loop(k);return virtualItems}),[indexes,defaultScrollToFn,horizontal,measurements]),mountedRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(!1);useIsomorphicLayoutEffect((function(){mountedRef.current&&setMeasuredCache({}),mountedRef.current=!0}),[estimateSize]);var scrollToOffset=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(toOffset,_temp){var _ref2$align=(void 0===_temp?{}:_temp).align,align=void 0===_ref2$align?"start":_ref2$align,_latestRef$current=latestRef.current,scrollOffset=_latestRef$current.scrollOffset,outerSize=_latestRef$current.outerSize;"auto"===align&&(align=toOffset<=scrollOffset?"start":toOffset>=scrollOffset+outerSize?"end":"start"),"start"===align?scrollToFn(toOffset):"end"===align?scrollToFn(toOffset-outerSize):"center"===align&&scrollToFn(toOffset-outerSize/2)}),[scrollToFn]),tryScrollToIndex=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(index,_temp2){var _ref3=void 0===_temp2?{}:_temp2,_ref3$align=_ref3.align,align=void 0===_ref3$align?"auto":_ref3$align,rest=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(_ref3,["align"]),_latestRef$current2=latestRef.current,measurements=_latestRef$current2.measurements,scrollOffset=_latestRef$current2.scrollOffset,outerSize=_latestRef$current2.outerSize,measurement=measurements[Math.max(0,Math.min(index,size-1))];if(measurement){if("auto"===align)if(measurement.end>=scrollOffset+outerSize)align="end";else{if(!(measurement.start<=scrollOffset))return;align="start"}var toOffset="center"===align?measurement.start+measurement.size/2:"end"===align?measurement.end:measurement.start;scrollToOffset(toOffset,_extends({align},rest))}}),[scrollToOffset,size]),scrollToIndex=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];tryScrollToIndex.apply(void 0,args),requestAnimationFrame((function(){tryScrollToIndex.apply(void 0,args)}))}),[tryScrollToIndex]);return{virtualItems,totalSize,scrollToOffset,scrollToIndex,measure}}var findNearestBinarySearch=function findNearestBinarySearch(low,high,getCurrentValue,value){for(;low<=high;){var middle=(low+high)/2|0,currentValue=getCurrentValue(middle);if(currentValue<value)low=middle+1;else{if(!(currentValue>value))return middle;high=middle-1}}return low>0?low-1:0}}}]);