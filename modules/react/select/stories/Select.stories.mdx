import {Meta} from '@storybook/addon-docs';
import {SymbolDoc, Specifications} from '@workday/canvas-kit-docs';

import {Select} from '@workday/canvas-kit-react/select';

import {Alert} from './examples/Alert';
import {Basic} from './examples/Basic';
import {Disabled} from './examples/Disabled';
import {DisabledOptions} from './examples/DisabledOption';
import {Error} from './examples/Error';
import {Grow} from './examples/Grow';
import {LabelPosition} from './examples/LabelPosition';
import {WithIcons} from './examples/WithIcons';
import {Required} from './examples/Required';
import {Scrollable} from './examples/Scrollable';
import {Dynamic} from './examples/Dynamic';
import {RefForwarding} from './examples/RefForwarding';

<Meta title="Components/Inputs/Select" component={Select} />

# Canvas Kit Select

Select inputs allow users to choose one option from a list of items or type a matching option.

[> Workday Design Reference](https://design.workday.com/components/inputs/select)

## Installation

```sh
yarn add @workday/canvas-kit-react
```

## Usage

### Basic Example

`Select` should be used in tandem with [Form Field](/components/inputs/form-field/) where the
`inputId` prop matches an `id` on the `<Select.Input/>` to meet accessibility standards. This
ensures the `label` text from `FormField` is attached to the `<Select.Input/>` and read out as a
group for voiceover.

<ExampleCodeBlock code={Basic} />

Our example uses [React state](<(https://react.dev/learn/state-a-components-memory)>) to track the
value of the `Select`.

### Label Position

Set the `labelPosition` prop of the wrapping `FormField` to designate the position of the label
relative to the `Select`. `labelPosition` accepts the following values:

- `FormField.LabelPosition.Top` (Default)
- `FormField.LabelPosition.Left`

<ExampleCodeBlock code={LabelPosition} />

### Required

Set the `required` prop of the wrapping `FormField` to `true` to indicate that the field is
required. Labels for required fields are suffixed by a red asterisk.

<ExampleCodeBlock code={Required} />

### Disabled

Set the `disabled` prop of `<Select.Input/>` to prevent users from interacting with it.

<ExampleCodeBlock code={Disabled} />

### Disabled Options

Set `nonInteractiveIds` to an array of `id`s that you want to disable interaction as well as
searchability when typing into the `Select`.

You will also need to set the aria attribute `aria-disabled` on the
`<Select.Item aria-disabled={item.disabled ? item.disabled : undefined}/>` if the item is disabled,
otherwise set the attribute to `undefined`. This ensures that the item is styled as disabled.

<ExampleCodeBlock code={DisabledOptions} />

### With Icons

Add `<Select.Item.Icon icon={yourIcon}/>` as a sub component of `<Select.Item/>` if you want to
render an icon for each item. The `<Select.Item.Icon/>` takes in an `icon` prop of type
`CanvasSystemIcon`. You can import icons from `@workday/canvas-system-icons-web`.

If you want to render the selected item's icon in the `<Select.Input/>` add the `iconStart` prop. To
get the current selected item's icon:

- Register your `items` with the `useSelectModel`
- Get current item by
  `const currentItem = model.navigation.getItem(model.state.selectedIds[0], model)`
- Pass the value to the input in the following way:
  `<Select.Input inputStartIcon={currentItem.value.icon} id="form-field-input-id" />`

**Notes: The `<Select.Input/>` will only render an icon when there is an item selected.**

<ExampleCodeBlock code={WithIcons} />

### Grow

Set the `grow` prop of the wrapping Form Field to `true` to configure the `<Select.Input/>` to
expand to the width of its container.

<ExampleCodeBlock code={Grow} />

### Scrollable

Set `maxHeight` prop on the `<Select.Card>` to determine the height of the dropdown menu. This will
allow the menu to scroll if there are enough items.

<ExampleCodeBlock code={Scrollable} />

### Ref Forwarding

`<Select.Input/>` supports [ref forwarding](https://reactjs.org/docs/forwarding-refs.html). It will
forward `ref` to its underlying `<input type="text" role="combobox">` element.

<ExampleCodeBlock code={RefForwarding} />

### Dynamic Items

`<Select>` supports a
[dynamic API](/getting-started/for-developers/resources/collection-api/#dynamic-items) where you
pass an array of `items` in the `model` config and provide a render function to display the items.
It's important to set up the object in your items array in a way for the
[collection system](/getting-started/for-developers/resources/collection-api/) to understand.

#### Array of strings

If you have an array of `strings`, the collection system will handle asigning an `id`, `index` and
`textValue` to each item in the array. This ensures that both type ahead and keyboard navigation
work correclty.

```tsx
const model = useSelectModel({
	items: ['Mobile', 'E-mail', 'Fax']
})
<>
<Select model={model}>
	<Select.Input id="dyamic-select" />
	<Select.Popper>
		<Select.Card maxHeight="200px">
			<Select.List>
				{item => {
					return (
						<Select.Item>
							{item}
						</Select.Item>
					);
				}}
			</Select.List>
		</Select.Card>
	</Select.Popper>
</Select>
Selected Value: {model.state.selectedIds[0]}
</>
```

#### Array of objects

If you have an array of `objects`, the collection system needs an `id` to ensure items are
registered and searchable. In most cases, the `id` should match your text value for each item. Any
additional information like icons or if the item is disabled can exist on the object and be used in
the render function.

```tsx
const model = useSelectModel({
	items: [{id: 'Mobile' icon: mobileIcon},{id:'E-mail', icon: emailIcon}, {id:'Fax' icon: faxIcon}]
})
<>
<Select model={model}>
	<Select.Input id="dynamic-select" />
	<Select.Popper>
		<Select.Card maxHeight="200px">
			<Select.List>
				{item => {
					return (
						<Select.Item>
							<Select.Item.Icon icon={item.icon} />
							{item.id}
						</Select.Item>
					);
				}}
			</Select.List>
		</Select.Card>
	</Select.Popper>
</Select>
Selected Value: {model.state.selectedIds[0]}
</>
```

<ExampleCodeBlock code={Dynamic} />

### Error States

Set the error prop of the wrapping `FormField` to `FormField.ErrorType.Alert` or
`FormField.ErrorType.Error` to set the `<Select>` to the alert or error state, respectively. You
will also need to set the `hintId` and `hintText` props on the `FormField` to meet accessibility
standards. You must set an `id` attribute on the `<Select.Input/>` element that matches the value of
`inputId` set on the `FormField` element. These attributes ensure that the alert message is
associated to the `<Select>` and read out by voiceover. **Note: The Select container component,
`<Select>` must wrap the `FormField` element to ensure prop styling on the `<Select.Input/>`
element.**

#### Alert

Use the alert state when a selection is valid but there is additional information.

<ExampleCodeBlock code={Alert} />

#### Error

Use the error state when the selection is no longer valid.

<ExampleCodeBlock code={Error} />

## Component API

<SymbolDoc name="Select" fileName="/react/" />
```
